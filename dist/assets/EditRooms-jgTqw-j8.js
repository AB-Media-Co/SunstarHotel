import{e as se,r as t,j as e,_ as r}from"./index-D2bEG4fB.js";import{i as le,u as ae,d as oe,j as te}from"./useHotelHook-Cghm7Ldv.js";import{R as ie,S as y,A as ne,M as re,T as ce,a as de}from"./AmenitiesData-CFX8dzC9.js";import"./axiosInstance-C7CYZqxk.js";import"./axios-upsvKRUO.js";import"./index-DjKJqAo0.js";import"./index-CRG5xrXQ.js";const he=()=>{var H;const{roomId:k}=se(),{data:i,isLoading:F,isError:$,error:q}=le(k),{data:g}=ae(),{mutate:z,isLoading:f}=oe(),{mutate:W}=te(),[h,R]=t.useState(null),[d,C]=t.useState(""),[v,S]=t.useState(""),[j,D]=t.useState(""),[N,E]=t.useState(0),[U,T]=t.useState([]),[I,L]=t.useState(0),[M,m]=t.useState([]),[P,A]=t.useState(!0),[B,O]=t.useState(!1),[u,_]=t.useState(0),[x,G]=t.useState(0),[c,p]=t.useState([]),J=((H=g==null?void 0:g.hotels)==null?void 0:H.map(s=>({value:s._id,label:s.name})))||[];t.useEffect(()=>{var s,o,l,n;if(i!=null&&i.room){const a=i.room;R({value:(s=a.hotel)==null?void 0:s._id,label:(o=a.hotel)==null?void 0:o.name}),C(a.roomType),S(a.roomNumber),D(a.description),E(a.roomLeft),T(a.amenities.map(b=>({value:b,label:b}))),L(a.rating),m(a.images),A(a.available),O(a.soldOut),_(((l=a.hotel)==null?void 0:l.price)||0),G(((n=a.hotel)==null?void 0:n.discountedPrice)||0),p(a.testimonials)}},[i]),t.useEffect(()=>{if(i!=null&&i.room){const s=i.room;m(s.images||[])}},[i]);const K=s=>{const o=new FormData;s.forEach(n=>o.append("images",n));const l=r.loading("Uploading images...");z(o,{onSuccess:n=>{m(a=>[...a,...n.imageUrls]),r.success("Images uploaded successfully!",{id:l})},onError:n=>{r.error(`Error uploading images: ${n.message}`,{id:l})}})},Q=s=>{m(o=>o.filter(l=>l!==s)),r.success("Image removed successfully!")},V=()=>{if(!h||!v||!j.trim()||N<0||!d||u<=0||x<=0){r.error("Please fill in all required fields.");return}if(x>u){r.error("Discounted price cannot exceed the original price.");return}const s=d.toLowerCase();if(!["single","double","suite","deluxe"].includes(s)){r.error("Invalid room type selected.");return}const o={hotelId:h.value,roomType:s,roomNumber:v.trim(),description:j.trim(),roomLeft:Number(N),amenities:U.map(l=>l.value),rating:Math.min(5,Math.max(0,Number(I))),images:M,available:P,soldOut:B,price:Number(u),discountedPrice:Number(x),testimonials:c.map(l=>({name:l.name.trim(),description:l.description.trim(),rating:Math.min(5,Math.max(0,Number(l.rating)))}))};W({id:k,data:o},{onSuccess:()=>{r.success("Room updated successfully")},onError:l=>{console.error("Update Error:",l),r.error("Error: "+((l==null?void 0:l.message)||"Failed to update room."))}})},w=(s,o,l)=>{const n=c.map((a,b)=>b===s?{...a,[o]:l}:a);p(n)},X=()=>{p([...c,{name:"",description:"",rating:0}])},Y=s=>{p(c.filter((o,l)=>l!==s))},Z=["Edit Room","Gallery","Customer Reviews"],ee={"Edit Room":e.jsxs("div",{className:"space-y-6 p-6 bg-white",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Rating"}),e.jsx(ie,{initialRating:I,setRating:L}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Room Number"}),e.jsx("input",{className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:v,onChange:s=>S(s.target.value)})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Room Type"}),e.jsx(y,{options:[{value:"single",label:"Single"},{value:"double",label:"Double"},{value:"suite",label:"Suite"},{value:"deluxe",label:"Deluxe"}],value:{value:d,label:d},onChange:s=>C(s.value)})]})]}),e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Description"}),e.jsx("textarea",{className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:j,onChange:s=>D(s.target.value)}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Select Hotel"}),e.jsx(y,{options:J,value:h,onChange:R})]}),e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Amenities"}),e.jsx(y,{isMulti:!0,options:ne,value:U,onChange:T})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Price"}),e.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:u,onChange:s=>_(Number(s.target.value))})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Discounted Price"}),e.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:x,onChange:s=>G(Number(s.target.value))})]})]}),e.jsxs("div",{className:"flex space-x-4 justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Rooms Left"}),e.jsx("input",{type:"number",className:"w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:N,onChange:s=>E(Number(s.target.value))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Available"}),e.jsx("input",{type:"checkbox",checked:P,onChange:s=>A(s.target.checked),className:"w-6 h-6 mt-2 border rounded"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-2xl font-semibold mb-2",children:"Sold Out"}),e.jsx("input",{type:"checkbox",checked:B,onChange:s=>O(s.target.checked),className:"w-6 h-6 mt-2 border rounded"})]})]})]}),Gallery:e.jsxs("div",{className:"p-6 space-y-4",children:[f&&e.jsxs("div",{className:"w-full text-center py-4",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Uploading images..."})]}),e.jsx(re,{onUploadSuccess:K,isUploading:f,imagesUrls:M,onRemoveImageUrl:Q,disabled:f})]}),"Customer Reviews":e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"flex justify-between flex-wrap",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Customer Reviews"})}),e.jsx("div",{className:"flex flex-wrap gap-6 w-full ",children:c.map((s,o)=>e.jsxs("div",{className:"p-4 border flex flex-col rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex gap-4 justify-between",children:[e.jsx("input",{type:"text",placeholder:"Customer Name",value:s.name,onChange:l=>w(o,"name",l.target.value),className:"w-full p-2 border rounded-lg"}),e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(l=>e.jsx("svg",{onClick:()=>w(o,"rating",l),xmlns:"http://www.w3.org/2000/svg",fill:l<=s.rating?"#F59E0B":"#D1D5DB",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6 cursor-pointer",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.999 1.49l2.93 5.93 6.54.953-4.735 4.62 1.117 6.516-5.852-3.076-5.852 3.076 1.117-6.516-4.735-4.62 6.54-.953 2.93-5.93z"})},l))})]}),e.jsx("textarea",{placeholder:"Review Description",value:s.description,onChange:l=>w(o,"description",l.target.value),className:"w-full p-2 h-36 border rounded-lg"}),e.jsx("button",{onClick:()=>Y(o),className:"text-red-500 py-1 px-3 rounded-lg",children:e.jsx(ce,{})})]},o))}),e.jsx("button",{onClick:X,className:"mt-4 bg-blue-500 text-white py-2 px-4 rounded-lg",children:"Add More"})]})};return F?e.jsx("div",{children:"Loading..."}):$?e.jsxs("div",{children:["Error: ",q.message]}):e.jsxs("div",{className:"bg-gray-50 min-h-screen py-4 flex flex-col pb-5",children:[e.jsxs("div",{className:"flex px-10 justify-between",children:[e.jsx("h1",{className:"text-[32px] font-bold pb-8 ",children:"Edit Room"}),e.jsx("button",{className:"bg-gradient-to-r h-[60px] w-[150px]  from-blue-500 to-indigo-600 text-white px-2 rounded-lg shadow-md hover:shadow-lg hover:from-blue-600 hover:to-indigo-700 transition-all",onClick:V,children:"Update"})]}),e.jsx(de,{tabNames:Z,tabContent:ee})]})};export{he as default};
