import{r as n,b as oe,v as ie,p as c,a as ce,i as I,j as e,I as _,N as de,a1 as me,a2 as xe,q as Q}from"./index-DsgwpIcm.js";import{a as g,i as O,b as N,s as ue,c as fe,d as A,e as k}from"./isSameMonth-CePgrAHp.js";import{a as U,A as he}from"./ArrowRightAlt-BU1-jgln.js";import{A as V}from"./ArrowForwardIos-DXvn1y-g.js";const je=({setCheckInDate:z,setCheckOutDate:P,setOpenCalender:X,hotelCode:T})=>{const[o,y]=n.useState(new Date),Y=g(o,1),{closeHotelModal:p,setNights:ge}=oe(),[r,w]=n.useState(null),[s,f]=n.useState(null),[b,F]=n.useState(!1),[L,Z]=n.useState(null),[x,u]=n.useState(!1),C=n.useRef(null),l=JSON.parse(localStorage.getItem("hotelInfo")),j=r&&s&&(l==null?void 0:l.hotelCode)&&(l==null?void 0:l.authKey),{data:D,isLoading:M}=ie(j?l.hotelCode:null,j?l.authKey:null,j?c(r,"yyyy-MM-dd"):null,j?c(s,"yyyy-MM-dd"):null);n.useEffect(()=>{const t=localStorage.getItem("checkInDate"),i=localStorage.getItem("checkOutDate");t&&i&&(w(new Date(t)),f(new Date(i)))},[]);const ee=t=>{!r||r&&s?(w(t),f(null),u(!1)):k(t,r)?(w(t),u(!1)):Q(t,r)>30?(f(t),u(!0)):(f(t),u(!1))},te=t=>{r&&!s&&Z(t)},W=ce(),H=n.useRef(D);n.useEffect(()=>{H.current=D},[D]);const B=n.useRef(M);n.useEffect(()=>{B.current=M},[M]);function re({timeout:t=5e3,interval:i=100}={}){return new Promise(m=>{const S=Date.now(),E=()=>{const v=H.current,a=B.current;if(v||!a)return m(v??null);if(Date.now()-S>=t)return m(null);setTimeout(E,i)};E()})}const se=n.useCallback(async()=>{if(!b){F(!0);try{if(!r||!s||O(r,s))return;const t=c(r,"yyyy-MM-dd"),i=c(s,"yyyy-MM-dd");z(t),P(i);try{typeof window<"u"&&(localStorage.setItem("checkInDate",t),localStorage.setItem("checkOutDate",i))}catch{}const m=T??(l==null?void 0:l.hotelCode);if(!m)return;await re({timeout:8e3,interval:120}),W(`/hotels/${m}`),p==null||p(),setOpenCalendar(!1)}catch(t){console.error("Error handling confirmation:",t)}finally{F(!1)}}},[b,r,s,z,P,T,l==null?void 0:l.hotelCode,W,p]),ae=["S","M","T","W","T","F","S"],K=(t,i,m)=>{const S=me(ue(t)),v=Array.from({length:42},(a,h)=>fe(S,h));return e.jsxs("div",{className:"calendar-month w-full lg:w-[48%] flex flex-col gap-4 relative  p-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[i&&e.jsx("button",{onClick:()=>y(g(o,-1)),className:`text-2xl hidden  rounded-full md:flex items-center justify-center w-10 h-10 transition-all transform hover:scale-105
                ${N(o,new Date)?"bg-gray-100 text-gray-300 cursor-not-allowed":"text-white bg-primary-green hover:bg-primary-green/90 cursor-pointer shadow-md"}`,disabled:N(o,new Date),"aria-label":"Previous month",children:e.jsx(U,{style:{width:"16px",height:"16px"}})}),e.jsx("h2",{className:"font-bold text-xl text-center w-full md:text-2xl text-primary-green",children:c(t,"MMMM yyyy")}),m&&e.jsx("button",{onClick:()=>y(g(o,1)),className:"text-2xl text-white bg-primary-green hover:bg-primary-green/90 rounded-full hidden md:flex items-center justify-center w-10 h-10 shadow-md cursor-pointer transition-all transform hover:scale-105","aria-label":"Next month",children:e.jsx(V,{style:{width:"16px",height:"16px"}})})]}),e.jsxs("div",{className:"px-1 md:px-4",children:[e.jsx("div",{className:"calendar-header grid grid-cols-7 text-sm md:text-base text-center font-medium text-gray-500 pb-2 border-b border-gray-100",children:ae.map((a,h)=>e.jsx("div",{className:"py-2",children:a},h))}),e.jsx("div",{className:"calendar-days grid grid-cols-7 gap-y-2 sm:gap-y-3 pt-2",children:v.map((a,h)=>{const d=c(a,"M")===c(t,"M"),R=d&&r&&A(a,r),q=d&&s&&A(a,s),G=L&&r&&!s&&d&&O(a,r)&&k(a,L),J=d&&r&&s&&O(a,r)&&k(a,s),$=k(a,xe(new Date)),le=A(a,new Date);return e.jsx("div",{className:`day-cell flex items-center justify-center h-10 sm:h-12 relative
                    transition-all duration-200 
                    ${d?"current-month":"other-month opacity-0"} 
                    ${R?"range-start bg-primary-green rounded-l-full z-10":""} 
                    ${q?"range-end bg-primary-green rounded-r-full z-10":""} 
                    ${J||G?"in-range bg-primary-green/20":""} 
                    ${$?"text-gray-300 cursor-not-allowed":d?"hover:bg-primary-green/10 cursor-pointer":""} 
                    ${le&&!R?"today ring-2 ring-primary-green/30 ring-inset":""}
                    `,onClick:()=>d&&!$&&ee(a),onMouseEnter:()=>d&&!$&&te(a),children:d&&e.jsx("div",{className:`
                      flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-full
                      text-sm md:text-base font-medium
                      ${R||q?"bg-primary-green text-white transform scale-110 shadow-md z-20":J||G?"text-primary-green":""}
                    `,children:c(a,"d")})},h)})})]})]})},ne=()=>{if(r&&s){const t=Q(s,r);return t===1?"1 Night":`${t} Nights`}return""};return n.useEffect(()=>{x&&C.current&&I.fromTo(C.current,{opacity:0,y:-20,scale:.95},{opacity:1,y:0,scale:1,duration:.5,ease:"back.out(1.7)"})},[x]),n.useEffect(()=>{I.fromTo(".Calender",{x:300,opacity:0},{duration:.8,x:0,opacity:1,ease:"power3.out"}),I.fromTo(".footer",{y:50,opacity:0},{duration:.8,y:0,opacity:1,ease:"power3.out",delay:.3})},[]),e.jsxs("div",{className:"calendar-container flex flex-col justify-start md:justify-end relative",children:[e.jsxs("div",{className:"flex flex-col  overflow-y-auto md:rounded-t-xl md:h-auto Calender max-h-[85vh] bg-white lg:w-[95%] w-full md:p-6 lg:flex-row gap-6 shadow-lg",children:[x&&e.jsx("div",{ref:C,className:`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 \r
              bg-white rounded-xl shadow-xl p-5 md:p-6 max-w-[90%] w-[320px] md:w-[360px]`,children:e.jsxs("div",{className:"flex flex-col items-center text-start",children:[e.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-primary-green/10 rounded-full flex items-center justify-center mb-3",children:e.jsx(_,{name:"calendar",className:"w-6 h-6 md:w-7 md:h-7 text-primary-green"})}),e.jsx("h3",{className:"text-lg md:text-xl font-bold text-primary-dark-green mb-2",children:"Planning a long stay?"}),e.jsx("p",{className:"text-gray-600 text-sm md:text-base mb-4",children:"Currently, we don't support online bookings for more than 30 nights. However, you can tell us about your plans and we'll make it happen."}),e.jsxs("div",{className:"flex justify-between w-full items-center",children:[e.jsx("div",{className:`text-primary-yellow  w-full cursor-pointer  font-bold  \r
                  transition-all duration-300  `,onClick:()=>window.location.href="/booking-form",children:"Get in touch"}),e.jsx("div",{className:" text-gray-500 hover:text-gray-700 w-full cursor-pointer  text-sm font-medium",onClick:()=>{localStorage.removeItem("checkInDate"),localStorage.removeItem("checkOutDate"),w(null),f(null),u(!1)},children:"Continue selection"})]})]})}),x&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm z-40",onClick:()=>u(!1)}),e.jsxs("div",{className:"flex flex-col w-full gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pt-4 md:hidden",children:[e.jsx("button",{onClick:()=>y(g(o,-1)),className:`rounded-full flex items-center justify-center w-8 h-8 
                ${N(o,new Date)?"bg-gray-100 text-gray-300 cursor-not-allowed":"text-white bg-primary-green hover:bg-primary-green/90 cursor-pointer"}`,disabled:N(o,new Date),children:e.jsx(U,{style:{width:"12px",height:"12px"}})}),e.jsx("h2",{className:"font-bold text-lg text-primary-green",children:"Select your stay dates"}),e.jsx("button",{onClick:()=>y(g(o,1)),className:"text-white bg-primary-green hover:bg-primary-green/90 rounded-full flex items-center justify-center w-8 h-8",children:e.jsx(V,{style:{width:"12px",height:"12px"}})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row w-full gap-6",children:[K(o,!0,!1),K(Y,!1,!0)]})]})]}),e.jsx("button",{onClick:()=>X(!1),className:"absolute right-4 top-4 text-gray-500 hover:text-gray-700 transition-colors bg-white/80 hover:bg-white rounded-full p-1 shadow-md z-20","aria-label":"Close calendar",children:e.jsx(de,{})}),e.jsxs("div",{className:`footer bg-white w-full py-4 md:py-6 shadow-lg\r
  fixed md:sticky bottom-0 left-0 z-40 \r
  px-4 md:px-8\r
  flex flex-col md:flex-row justify-between gap-4 items-center `,children:[e.jsxs("div",{className:"flex flex-row items-center justify-between w-full md:w-auto md:max-w-[60%] bg-gray-50 px-4 py-3 md:px-6 md:py-4 rounded-xl gap-3 shadow-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{name:"calendar",className:"w-5 h-5 md:w-6 md:h-6 text-primary-green mr-2"}),e.jsxs("div",{className:`flex flex-col ${b&&!r?"text-red-500":"text-gray-700"}`,children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check in"}),e.jsx("span",{className:"font-semibold text-[10px] md:text-base",children:r?c(r,"EEE, MMM d"):"Select date"})]})]}),e.jsx(he,{className:"text-primary-green mx-1 md:mx-2"}),e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:`flex flex-col ${b&&!s?"text-red-500":"text-gray-700"}`,children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check out"}),e.jsx("span",{className:"font-semibold text-[10px] md:text-base",children:s?c(s,"EEE, MMM d"):"Select date"})]})}),r&&s&&e.jsx("div",{className:"flex items-center justify-center text-xs md:text-sm font-medium text-primary-green bg-primary-green/10 rounded-full px-3 py-1 ml-2",children:ne()})]}),e.jsx("button",{onClick:se,disabled:x,className:`w-full md:w-auto font-bold text-white px-6 py-3 md:py-4 rounded-xl shadow-lg transition-all duration-300 
              ${!r||!s||x?"bg-gray-300 cursor-not-allowed":"bg-primary-dark-green hover:bg-primary-green transform hover:scale-105"}`,children:"Confirm Dates"})]})]})};export{je as C};
