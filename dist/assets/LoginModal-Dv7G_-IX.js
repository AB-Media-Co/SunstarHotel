import{K as D,r as m,bp as F,bq as A,br as z,j as e,bl as K,Z as c}from"./index-DsgwpIcm.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=D("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),_=({closeModal:h})=>{const[a,d]=m.useState(1),[n,w]=m.useState(""),[i,k]=m.useState({firstName:"",lastName:"",phone:""}),[x,y]=m.useState(["","","","","",""]),[u,j]=m.useState(!1),[l,o]=m.useState(!1),[p,N]=m.useState(!1),g=F(),E=A(),{data:b,refetch:S}=z(n),C=async()=>{var t;if(!n.includes("@")){c.error("Enter a valid email");return}N(!0);try{(t=(await S()).data)!=null&&t.verified?(o(!0),g.mutate({email:n},{onSuccess:()=>{o(!1),d(3)},onError:()=>{o(!1)}})):d(2)}catch(s){console.error("Failed to verify email. Please try again.",s)}finally{N(!1)}},P=()=>{const{firstName:t,lastName:s,phone:r}=i;if(!t.trim()){c.error("Please enter your first name");return}if(!s.trim()){c.error("Please enter your last name");return}if(!r.trim()){c.error("Please enter your phone number");return}if(r.length<10){c.error("Please enter a valid phone number");return}o(!0),g.mutate({email:n,...i},{onSuccess:()=>{o(!1),d(3)},onError:()=>{o(!1),console.error("Failed to send OTP. Please try again.")}})},O=async()=>{const t=x.join("");if(t.length!==6){c.error("Please enter full 6-digit OTP");return}j(!0),E.mutate({email:n,otp:t,...i},{onSuccess:()=>{localStorage.setItem("user_email",n),localStorage.setItem("user_email",n),h()},onError:()=>{j(!1),console.error("Invalid OTP. Please try again.")}})},L=(t,s)=>{if(s.length<=1){const r=[...x];if(r[t]=s,y(r),s&&t<6){const v=document.getElementById(`otp-${t+1}`);v&&v.focus()}}},I=(t,s)=>{if(s.key==="Backspace"&&!x[t]&&t>0){const r=document.getElementById(`otp-${t-1}`);r&&r.focus()}},T=()=>{o(!0),y(["","","","","",""]),g.mutate({email:n,...i},{onSuccess:()=>{o(!1)},onError:()=>{o(!1)}})},f=(t,s)=>{k(r=>({...r,[t]:s}))},V=()=>a===2?1:a===3?b!=null&&b.verified?1:2:1,B={1:"/images/Loginorjoin.png",2:"/images/completeprofile.png",3:"/images/verifyemail.png"};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-2xl w-full max-w-sm sm:max-w-md md:max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col md:flex-row",children:[e.jsx("div",{className:"hidden md:block md:w-1/2",children:e.jsx("img",{src:B[a],alt:a===1?"Login or Join":a===2?"Complete Your Profile":"Verify Email",className:"object-cover object-center w-full h-full"})}),e.jsxs("div",{className:"flex-1 p-4 sm:p-6 md:p-8 relative overflow-y-auto",children:[e.jsx("button",{onClick:h,className:"absolute top-3 right-3 sm:top-4 sm:right-4 md:top-6 md:right-6 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:e.jsx(K,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-500"})}),(a===2||a===3)&&e.jsxs("button",{onClick:()=>d(V()),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4 sm:mb-6 transition-colors",children:[e.jsx(R,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Back"})]}),e.jsxs("div",{className:"max-w-sm sm:max-w-md mx-auto pt-2  md:pt-0",children:[a===1&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Login or Join"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:"Track bookings, get rewards & enjoy up to 15% off with Sunstar."}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Email Address"}),e.jsx("input",{type:"email",value:n,onChange:t=>w(t.target.value),placeholder:"Enter Email Address",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:p||l})]}),e.jsx("button",{onClick:C,disabled:p||l,className:"w-full bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors text-sm sm:text-base",children:p?"Checking...":l?"Sending OTP...":"Continue"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-4 sm:mt-6",children:"By continuing, you agree to the terms of use, privacy & cookie policy."})]}),a===2&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Complete Your Profile"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:"Please provide your details to continue"}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"First Name"}),e.jsx("input",{type:"text",value:i.firstName,onChange:t=>f("firstName",t.target.value),placeholder:"Enter First Name",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Last Name"}),e.jsx("input",{type:"text",value:i.lastName,onChange:t=>f("lastName",t.target.value),placeholder:"Enter Last Name",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Phone Number"}),e.jsx("input",{type:"tel",value:i.phone,onChange:t=>f("phone",t.target.value),placeholder:"Enter Phone Number",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:l})]}),e.jsx("button",{onClick:P,disabled:l,className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors text-sm sm:text-base",children:l?"Sending OTP...":"Continue"})]})]}),a===3&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Verify Email"}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:["Enter the 6-digit OTP sent to ",n]}),e.jsx("div",{className:"flex gap-2 sm:gap-3 justify-center",children:x.map((t,s)=>e.jsx("input",{id:`otp-${s}`,type:"text",value:t,onChange:r=>L(s,r.target.value),onKeyDown:r=>I(s,r),className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 text-center text-black text-lg sm:text-xl font-semibold border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",maxLength:"1",disabled:u},s))}),e.jsx("button",{onClick:O,className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white py-2 sm:py-3 px-4 sm:px-6 rounded-lg font-semibold transition-colors text-sm sm:text-base",disabled:u,children:u?"Verifying...":"Continue"}),e.jsxs("p",{className:"text-xs sm:text-sm mt-4 text-gray-500 text-center",children:["Didn't get a code?",e.jsx("button",{className:"underline text-primary-green ml-1 disabled:text-gray-400",onClick:T,disabled:l||u,children:l?"Sending...":"Resend OTP"})]})]})]})]})]})})};export{_ as L};
